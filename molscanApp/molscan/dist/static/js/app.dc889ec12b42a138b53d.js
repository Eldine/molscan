webpackJsonp([1],{0:function(e,t){},COCH:function(e,t){},LTqA:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("7+uW"),r=s("NYxO"),i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var a=s("VU/8")({name:"App"},i,!1,function(e){s("y9Hz")},null,null).exports,c=s("/ocq"),o=s("Xxa5"),l=s.n(o),u=s("exGp"),d=s.n(u),h=s("BO1k"),m=s.n(h),f=s("mtWM"),v=s.n(f),p=s("qK+J"),g=s.n(p),_={props:{molecule:Object,index:Number,max:Number},methods:{seeDetail:function(){this.$root.$emit("seeDetail",this.index)},save:function(){this.molecule.isSelected=!1;var e={};e.id=this.molecule.id,e.formula=this.molecule.formula,e.isSelected=!1,this.$root.$emit("saveMol",e)}}},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ui card msrItem",attrs:{title:e.molecule.name}},[s("img",{staticClass:"mol-img",staticStyle:{"border-radius":"0px!important"},attrs:{src:e.molecule.img},on:{click:e.seeDetail}}),e._v(" "),s("sui-label",{staticClass:"save-label",attrs:{slot:"corner",size:"mini",color:"grey",corner:"right"},on:{click:e.save},slot:"corner"},[s("sui-icon",{staticClass:"save",attrs:{name:"save"}})],1),e._v(" "),s("sui-card-content",{staticStyle:{border:"0px"}},[s("sui-card-header",[e._v(" "+e._s(e.molecule.formula)+" ")]),e._v(" "),s("sui-card-meta",[e._v(" "+e._s(e.molecule.sources.length>1?"sources":"source")+": "+e._s(e.molecule.sources.toString())+" ")]),e._v(" "),s("sui-card-meta",[e._v(" Poids : "+e._s(e.molecule.id)+" g/mol")]),e._v(" "),s("span",{staticClass:"mol-num"},[e._v(" "+e._s(e.index+1)+" / "+e._s(e.max)+" ")]),e._v(" "),s("sui-card-description")],1)],1)},staticRenderFns:[]};var x=s("VU/8")(_,b,!1,function(e){s("b77a")},null,null).exports,S={props:{molecules:Array,index:Number},data:function(){return{molecule:this.molecules[this.index],jsmol:"https://chemapps.stolaf.edu/jmol/jmol.php?model="+this.molecules[this.index].smile}},methods:{close:function(){this.$root.$emit("close")}}},y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dimmer"},[s("sui-icon",{staticClass:"close-icon",attrs:{name:"close inverted",size:"big"},on:{click:e.close}}),e._v(" "),e.molecule?s("article",[s("img",{staticClass:"molimg",staticStyle:{"border-radius":"0px!important"},attrs:{src:e.molecule.img}}),e._v(" "),s("section",[s("p",[e._m(0),e._v(e._s(e.molecule.name))]),e._v(" "),s("p",[e._m(1),e._v(e._s(e.molecule.formula))]),e._v(" "),s("p",[e._m(2),e._v(e._s(e.molecule.smile))]),e._v(" "),s("p",[e._m(3),e._v(e._s(e.molecule.inchi))]),e._v(" "),s("p",[e._m(4),e._v(e._s(e.molecule.inchi_key))]),e._v(" "),s("p",[e._m(5),e._v(e._s(e.molecule.weight)+" g/mol")]),e._v(" "),s("p",[s("a",{attrs:{href:e.jsmol,target:"_blank"}},[e._v("Visualiser en 3D")])]),e._v(" "),s("p",[s("strong",[e._v("\n          "+e._s(e.molecule.sources.length>1?"sources":"source")+" "),s("br")]),e._v(e._s(e.molecule.sources.toString())+"\n      ")])])]):e._e()],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("strong",[this._v("Nom "),t("br")])},function(){var e=this.$createElement,t=this._self._c||e;return t("strong",[this._v("Formule chimque "),t("br")])},function(){var e=this.$createElement,t=this._self._c||e;return t("strong",[this._v("Smile "),t("br")])},function(){var e=this.$createElement,t=this._self._c||e;return t("strong",[this._v("Inchi "),t("br")])},function(){var e=this.$createElement,t=this._self._c||e;return t("strong",[this._v("InchiKey "),t("br")])},function(){var e=this.$createElement,t=this._self._c||e;return t("strong",[this._v("Poids "),t("br")])}]};var k=s("VU/8")(S,y,!1,function(e){s("rrYP")},"data-v-391af4c0",null).exports,q={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("header",[s("div",{staticClass:"container"},[e._m(0),e._v(" "),s("div",{staticClass:"search-div"},[s("div",{staticClass:"ui icon input input-search"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newRequest,expression:"newRequest"}],attrs:{type:"text",placeholder:"Ajouter un fragment"},domProps:{value:e.newRequest},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.addRequest(e.newRequest),e.newRequest=""},input:function(t){t.target.composing||(e.newRequest=t.target.value)}}}),e._v(" "),s("i",{staticClass:"plus brown link icon",on:{click:function(t){e.addRequest(e.newRequest),e.newRequest=""}}})]),e._v(" "),s("div",{staticClass:"search-group",on:{click:e.search}},[s("button",{staticClass:"ui right labeled icon button search-btn"},[e._v("\n          Rechercher\n        ")]),e._v(" "),s("i",{staticClass:"circular inverted search icon"})])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h2",[t("span",[this._v("Mol")]),this._v("Scan")])}]};var R=s("VU/8")({data:function(){return{newRequest:""}},computed:{requests:function(){return this.$store.getters.requests}},methods:{addRequest:function(e){this.$root.$emit("addRequest",e)},search:function(){this.$root.$emit("search")}}},q,!1,function(e){s("xjZs")},"data-v-180b2799",null).exports,C=new(0,s("pqjY").XmlEntities),w={name:"MoleculeSearch",components:{moleculeView:x,InfiniteLoading:g.a,moleculeDetail:k,TheHeader:R},data:function(){return{page:0,hiding:!0,strictT:"Recherche non stricte",display3dT:"Affichage 2D",databaseT:"Rechercher partout",display3d:!1,strict:!1,newRequest:"",database:"all",isNewSearch:!1,isStrictSearch:!1,hideMenu1:!1,hideMenu2:!1,hideMenu3:!1,hideMenu4:!1,nbRequest:20,results:[],selectedRequestNames:[],detailIndex:0,seeDetail:!1,firstRequest:!0}},computed:{loading:function(){return this.$store.getters.loading},databases:function(){return this.$store.getters.databases},dbSelected:function(){return this.$store.getters.dbSelected},requests:function(){return this.$store.getters.requests},selectedRequests:function(){return this.$store.getters.selectedRequests},molecules:function(){var e=this;return this.$store.getters.molecules.filter(function(t){return e.inArray(t.requests,e.selectedRequestNames)})},molSaved:function(){return this.$store.getters.molSaved},molSavedSelected:function(){return this.$store.getters.molSavedSelected}},watch:{molecules:{handler:function(e){console.log("change:"+e.length),this.$store.dispatch("setLoading",!1),this.setMoleculesDisplay(this.display3d),this.updateResults()},deep:!0},selectedRequests:{handler:function(e){},deep:!0},requests:{handler:function(e){console.log("request change"),0===this.requests.length&&(this.$store.dispatch("clearMolecules"),this.firstRequest=!0)},deep:!0},display3d:function(e){this.setMoleculesDisplay(e)}},methods:{updateResults:function(){this.results=[],this.page=0,this.loadMore()},search:function(){var e=this;this.firstRequest=!1,this.selectedRequestNames=[];var t=!0,s=!1,n=void 0;try{for(var r,i=m()(this.selectedRequests);!(t=(r=i.next()).done);t=!0){var a=r.value;this.selectedRequestNames.push(a.name)}}catch(e){s=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(s)throw n}}this.requests.forEach(function(t){t.isSelected&&(console.log("------"),e.databases[0].isSelected&&e.databases[1].isSelected&&!t.pubchemRequested&&!t.chemblRequested?e.$store.dispatch("searchMolecules",t.name):e.databases[1].isSelected&&!t.chemblRequested?e.$store.dispatch("searchWithChembl",t.name):(e.databases[0].isSelected=!0,t.pubchemRequested||e.$store.dispatch("searchWithPubchem",t.name)))}),this.updateResults()},loadMore:function(){var e=d()(l.a.mark(function e(){var t,s,n,r,i,a,c,o,u,d;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=Math.min(this.molecules.length,this.page+20),console.log("infinite: +"+t),s=[],n=void 0,r=this.page;r<t;r++)!1===(i=this.molecules[r]).requested&&s.push(i.id);if(!(s.length>0)){e.next=10;break}return a="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+s.toString()+"/property/MolecularFormula,MonoisotopicMass,IUPACName,CanonicalSMILES,InChIKey,InChI,MolecularWeight",e.next=9,v.a.get(a).then(function(e){return console.log("suceeeeeeeeeeeeeeeeees"),e}).catch(function(e){return console.log(e),[]});case 9:n=e.sent;case 10:for(c=0,o=this.page;o<t;o++)u=this.molecules[o],c++,n&&(d=n.data.PropertyTable.Properties[c])&&(u.name=d.IUPACName,u.formula=d.MolecularFormula,u.smile=d.CanonicalSMILES,u.inchi_key=d.InChIKey,u.inchi=d.InChI,u.weight=d.MolecularWeight,u.heavy_atom_count=d.HeavyAtomCount,u.monoisotopic_mass=d.MonoisotopicMass),this.results.push(u),this.page++;this.refreshResults();case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),setMoleculesDisplay:function(e){e?(this.molecules.forEach(function(e){e.img=e.img3d}),this.refreshResults()):(this.molecules.forEach(function(e){e.img=e.img2d}),this.refreshResults())},displayImgTo2d:function(e){e.img=e.img2d},displayImgTo3d:function(e){e.img=e.img3d},addRequest:function(e){e=C.encode(e.trim());var t=!1;if(this.requests.length>0){var s=!0,n=!1,r=void 0;try{for(var i,a=m()(this.requests);!(s=(i=a.next()).done);s=!0){if(i.value.name===e){t=!0,console.log("in request");break}}}catch(e){n=!0,r=e}finally{try{!s&&a.return&&a.return()}finally{if(n)throw r}}}""===e||t||(console.log("add-request"),this.$store.dispatch("addRequest",{name:e,isSelected:!0,pubchemRequested:!1,chemblRequested:!1}))},deleteRequest:function(e){this.$store.dispatch("setRequests",this.requests.filter(function(t){return t!==e}))},clearRequests:function(){this.$store.dispatch("clearRequests")},importerTexte:function(e){var t=this,s=e.target.files[0],n=new FileReader;n.onload=function(e){var s=n.result.split(/[\s,;\t\n]+/);console.log(s),s.forEach(function(e){t.addRequest(e)})},n.readAsText(s)},refreshResults:function(){for(var e=this,t=0;t<5;t++)setTimeout(function(){e.hiding=!0},20*t),setTimeout(function(){e.hiding=!1},30*t),setTimeout(function(){e.hiding=!0},40*t)},hideMenus:function(){this.hideMenu1=!1,this.hideMenu2=!1,this.hideMenu3=!1,this.hideMenu4=!1},inArray:function(e,t){if(this.$store.dispatch("setLoading",!0),0===t.length)return!1;if(t.length>e.length)return!1;var s=!0,n=!1,r=void 0;try{for(var i,a=m()(t);!(s=(i=a.next()).done);s=!0){var c=i.value;if(!e.includes(c))return!1}}catch(e){n=!0,r=e}finally{try{!s&&a.return&&a.return()}finally{if(n)throw r}}return!0},clearMolSaved:function(){this.$store.dispatch("clearMolSaved")},deleteMolSaved:function(e){this.$store.dispatch("setMolSaved",this.molSaved.filter(function(t){return t!==e}))},exportToSDF:function(){console.log("export--"+this.molSavedSelected.length);var e=[],t=!0,s=!1,n=void 0;try{for(var r,i=m()(this.molSavedSelected);!(t=(r=i.next()).done);t=!0){var a=r.value;e.push(a.id)}}catch(e){s=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(s)throw n}}e.length>0&&(location.href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+e.toString()+"/SDF")},documentClick:function(e){this.hideMenus()}},mounted:function(){var e=this;document.addEventListener("click",this.documentClick),this.$root.$on("close",function(t){e.seeDetail=!1}),this.$root.$on("seeDetail",function(t){e.detailIndex=t,e.seeDetail=!0,console.log("val: "+t)}),this.$root.$on("saveMol",function(t){e.$store.dispatch("saveMolecule",t)}),this.$root.$on("addRequest",function(t){e.addRequest(t)}),this.$root.$on("search",function(){e.search()})},destroyed:function(){document.removeEventListener("click",this.documentClick)}},M={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"container",attrs:{"infinite-scroll-distance":"5"}},[s("TheHeader"),e._v(" "),s("div",{staticClass:"page flex"},[s("section",[s("div",{staticClass:"ui transparent vertical menu submenu"},[e._m(0),e._v(" "),s("div",{staticClass:"item searchs"},[s("perfect-scrollbar",{staticClass:"scroll"},[s("div",{staticClass:"itemList"},e._l(e.requests,function(t,n){return s("div",{key:n,staticClass:"ui checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.isSelected,expression:"request.isSelected"}],attrs:{type:"checkbox",id:"box"+n},domProps:{checked:Array.isArray(t.isSelected)?e._i(t.isSelected,null)>-1:t.isSelected},on:{change:function(s){var n=t.isSelected,r=s.target,i=!!r.checked;if(Array.isArray(n)){var a=e._i(n,null);r.checked?a<0&&e.$set(t,"isSelected",n.concat([null])):a>-1&&e.$set(t,"isSelected",n.slice(0,a).concat(n.slice(a+1)))}else e.$set(t,"isSelected",i)}}}),e._v(" "),s("label",{attrs:{for:"box"+n}},[e._v(e._s(t.name)+" "),s("i",{staticClass:"delete icon",on:{click:function(s){e.deleteRequest(t)}}})])])}))])],1),e._v(" "),e._m(1),e._v(" "),s("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"file"},on:{change:e.importerTexte}}),e._v(" "),s("a",{staticClass:"item",on:{click:function(t){return t.preventDefault(),e.clearRequests(t)}}},[s("i",{staticClass:"trash alternate outline icon"}),e._v(" Tout vider ")]),e._v(" "),s("div",{staticClass:"ui dropdown item",on:{click:function(t){t.stopPropagation(),e.hideMenus(),e.hideMenu2=!e.hideMenu2}}},[e._v(e._s(e.display3dT)+" "),s("i",{staticClass:"dropdown icon"}),e._v(" "),s("div",{staticClass:"menu",class:{"transition visible":e.hideMenu2}},[s("a",{staticClass:"item",on:{click:function(t){t.stopPropagation(),e.display3d=!1,e.hideMenus(),e.display3dT="Affichage 2D"}}},[e._v("Affichage 2D")]),e._v(" "),s("a",{staticClass:"item",on:{click:function(t){t.stopPropagation(),e.display3d=!0,e.hideMenus(),e.display3dT="Affichage 3D"}}},[e._v("Affichage 3D")])])])]),e._v(" "),s("div",{staticClass:"ui transparent vertical menu submenu",staticStyle:{"margin-top":"-2px!important"}},[e._m(2),e._v(" "),s("div",{staticClass:"item searchs",staticStyle:{background:"#FFF"}},[s("div",{staticClass:"itemList"},e._l(e.databases,function(t,n){return s("div",{key:n,staticClass:"ui checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.isSelected,expression:"database.isSelected"}],attrs:{type:"checkbox",id:"database"+n},domProps:{checked:Array.isArray(t.isSelected)?e._i(t.isSelected,null)>-1:t.isSelected},on:{change:function(s){var n=t.isSelected,r=s.target,i=!!r.checked;if(Array.isArray(n)){var a=e._i(n,null);r.checked?a<0&&e.$set(t,"isSelected",n.concat([null])):a>-1&&e.$set(t,"isSelected",n.slice(0,a).concat(n.slice(a+1)))}else e.$set(t,"isSelected",i)}}}),e._v(" "),s("label",{staticStyle:{"font-size":"13.5px!important"},attrs:{for:"database"+n}},[e._v(e._s(t.name))])])}))])]),e._v(" "),s("div",{staticClass:"ui transparent vertical menu submenu",staticStyle:{"margin-top":"-2px!important"}},[e._m(3),e._v(" "),s("div",{staticClass:"item searchs",staticStyle:{background:"#FFF"}},[s("perfect-scrollbar",{staticClass:"scroll v2",staticStyle:{background:"#FFF",height:"70px","margin-bottom":"10px"}},[s("div",{staticClass:"itemList"},e._l(e.molSaved,function(t,n){return s("div",{key:n,staticClass:"ui checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.isSelected,expression:"mol.isSelected"}],attrs:{type:"checkbox",id:"sav"+n},domProps:{checked:Array.isArray(t.isSelected)?e._i(t.isSelected,null)>-1:t.isSelected},on:{change:function(s){var n=t.isSelected,r=s.target,i=!!r.checked;if(Array.isArray(n)){var a=e._i(n,null);r.checked?a<0&&e.$set(t,"isSelected",n.concat([null])):a>-1&&e.$set(t,"isSelected",n.slice(0,a).concat(n.slice(a+1)))}else e.$set(t,"isSelected",i)}}}),e._v(" "),s("label",{attrs:{for:"sav"+n}},[e._v(e._s(t.formula)+" "),s("i",{staticClass:"delete icon",on:{click:function(s){e.deleteMolSaved(t)}}})])])}))]),e._v(" "),s("div",{staticClass:"ui tiny basic icon fluid buttons"},[s("button",{staticClass:"ui button",on:{click:e.clearMolSaved}},[s("i",{staticClass:"trash alternate outline icon"})]),e._v(" "),s("button",{staticClass:"ui button",on:{click:e.exportToSDF}},[s("i",{staticClass:"download icon"})])])],1)])]),e._v(" "),s("div",{staticClass:"results"},[e.loading?s("sui-segment",{staticClass:"message-result"},[s("sui-dimmer",{attrs:{active:"",inverted:""}},[s("sui-loader",{attrs:{content:"Recherche en cours"}})],1)],1):e._e(),e._v(" "),!e.loading&&e.requests.length>0&&e.results.length<=0&&!e.firstRequest?s("div",{staticClass:"message-result",staticStyle:{color:"#555"}},[e._v("Auncun résultat trouvé pour les fragments sélectionnés")]):e._e(),e._v(" "),!e.loading&&e.requests.length>0&&e.results.length<=0&&e.firstRequest?s("div",{staticClass:"message-result",staticStyle:{color:"#555"}},[e._v("Commencer la recherche en cliquant sur le "),s("br"),e._v(" bouton correspondant ci-dessus")]):e._e(),e._v(" "),0!=e.requests.length||e.loading?e._e():s("div",{staticClass:"message-result"},[e._v("Ajouter un nouveau fragment moléculaire dans la liste de vos recherches "),s("br"),e._v(" en renseignant son code smile dans le champ correspondant.")]),e._v(" "),e.loading?e._e():s("masonry",{attrs:{cols:3,gutter:12}},e._l(e.results,function(t,n){return s("div",{key:n},[e.hiding?s("sui-card",{tag:"molecule-view",attrs:{molecule:t,index:n,max:e.molecules.length}}):s("molecule-view",{attrs:{molecule:t,index:n,max:e.molecules.length}})],1)}))],1)])],1),e._v(" "),e.seeDetail?s("moleculeDetail",{attrs:{molecules:e.results,index:e.detailIndex}}):e._e()],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"item",staticStyle:{"padding-top":"17px","padding-bottom":"17px",background:"#FFFAFA",color:"#666"}},[t("strong",[this._v("Fragments à recherchés ")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("label",{staticClass:"item import-file",attrs:{for:"file"}},[t("i",{staticClass:"arrow red alternate circle up icon"}),this._v("\n            Importer")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"item",staticStyle:{"padding-top":"12px","padding-bottom":"15px",background:"#FFFAFA",color:"#666"}},[t("strong",[this._v("Bases de données chimiques")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"item",staticStyle:{"padding-top":"12px","padding-bottom":"15px",background:"#FFFAFA",color:"#666"}},[t("strong",[this._v("Molécules sauvegardées ")])])}]};var $=s("VU/8")(w,M,!1,function(e){s("COCH"),s("LTqA")},"data-v-6adb7da0",null).exports;n.a.use(c.a);var A,F,E=new c.a({routes:[{path:"/",name:"MolScan",component:$}]}),I=s("8+8L"),L=s("myK/"),T=s.n(L),D=s("G7ha"),N=s("EPAd"),P=s.n(N),j=s("//Fk"),W=s.n(j),B=this,H=function(e){return new W.a(function(t){return setTimeout(t,e)})},K={search_molecule_structures:(A=d()(l.a.mark(function e(t){var s,n,r,i,a,c,o,u;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return X.dispatch("setLoading",!0),console.log("api --chembl"),s=[],n="https://www.ebi.ac.uk/chembl/api/data/substructure/",r="https://www.ebi.ac.uk/chembl/api/data/image/",e.next=7,v.a.get(n+t+"?format=json&limit=5000").then(function(e){return e.data.molecules}).catch(function(e){return[]});case 7:i=e.sent,a=5e3,c=l.a.mark(function e(){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o>=a)){e.next=2;break}return e.abrupt("return","break");case 2:return(n={}).sources=["chembl"],n.isSelected=!1,n.requests=[t],n.sourceId=i[o].molecule_chembl_id,n.requested=!0,n.img2d=r+n.sourceId,n.img3d="",n.img=n.img2d,n.name=i[o].pref_name,n.formula=i[o].molecule_properties.full_molformula,n.smile=i[o].molecule_structures.canonical_smiles,n.inchi_key=i[o].molecule_structures.standard_inchi_key,n.inchi=i[o].molecule_structures.standard_inchi,n.weight=i[o].molecule_properties.mw_freebase,n.heavy_atom_count=i[o].molecule_properties.heavy_atoms,n.monoisotopic_mass=i[o].molecule_properties.mw_monoisotopic,e.t0=v.a.get("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/InChIKey/"+n.inchi_key.trim()+"/cids/txt").then(function(e){return console.log(e.data),e.data}),e.next=22,H(10);case 22:return e.t1=e.sent,e.t2=function(e){return console.log(e),console.log(n.inchi_key),n.sourceId},e.next=26,e.t0.then.call(e.t0,e.t1).catch(e.t2);case 26:n.id=e.sent,console.log(n.id),isNaN(n.id)?s.push(n.id+"&"+n.name+"&"+n.formula+"&"+n.smile+"&"+n.inchi_key+"&"+n.inchi+"&"+n.weight+"&"+n.heavy_atom_count+"&"+n.monoisotopic_mass):s.push(n.id),X.dispatch("setLoading",!0);case 30:case"end":return e.stop()}},e,B)}),e.t0=l.a.keys(i);case 11:if((e.t1=e.t0()).done){e.next=19;break}return o=e.t1.value,e.delegateYield(c(),"t2",14);case 14:if("break"!==e.t2){e.next=17;break}return e.abrupt("break",19);case 17:e.next=11;break;case 19:if(u="http://localhost:3000/add",console.log(u),!(s.length>0)){e.next=24;break}return e.next=24,v.a.post(u,{db:"chembl",frag:t,res:s.toString()}).then(console.log("chembl adding in db ")).catch(function(){console.log("error")});case 24:case"end":return e.stop()}},e,B)})),function(e){return A.apply(this,arguments)})},U=this,V=function(e){return new W.a(function(t){return setTimeout(t,e)})},O=function(){var e=d()(l.a.mark(function e(t,s){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,e.t0=v.a.get(t),e.next=4,V(s);case 4:return e.t1=e.sent,e.t2=function(e){n=e},e.t3=function(e){n=e.response},e.next=9,e.t0.then.call(e.t0,e.t1).then(e.t2).catch(e.t3);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}},e,this)}));return function(t,s){return e.apply(this,arguments)}}(),z={search_molecule_structures:(F=d()(l.a.mark(function e(t){var s,n,r,i,a,c,o,u,d,h;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("api -- pubchem:"+X.getters.requests.length),t=t.trim(),s="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/substructure/smiles/"+t+"/json?MaxRecords=800000&MaxSeconds=2000",n=20,r=[],X.dispatch("setLoading",!0);case 6:if(!(n>0)){e.next=47;break}return e.next=9,O(s,0);case 9:if(i=e.sent,console.log("ok : "+i),void 0===i.data.Waiting){e.next=43;break}a=i.data.Waiting.ListKey,console.log("1res"+n+" : waiting "+a),c=0;case 15:if(!(n>0)){e.next=41;break}return X.dispatch("setLoading",!0),o="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/listkey/"+a+"/cids/json",e.next=20,O(o,5e3);case 20:if(void 0===(i=e.sent).data.IdentifierList){e.next=27;break}console.log("2res"+n+" : success"),r=i.data.IdentifierList.CID,n=0,e.next=39;break;case 27:if(void 0===i.data.Waiting){e.next=36;break}if(console.log("2res"+n+" : waiting"),!(++c>4)){e.next=32;break}return e.abrupt("break",41);case 32:a=i.data.Waiting.ListKey,n--,e.next=39;break;case 36:return console.log("2res"+n+" : error"),n--,e.abrupt("break",41);case 39:e.next=15;break;case 41:e.next=45;break;case 43:console.log("1res"+n+" : error"),n--;case 45:e.next=6;break;case 47:if(u=(u=r).slice(0,1e5),console.log(u.length),d="http://localhost:3000/add",console.log(d),h=u.toString(),!(u.length>0)){e.next=56;break}return e.next=56,v.a.post(d,{db:"pubchem",frag:t,res:h}).then(console.log("adding in db")).catch(function(){console.log("error")});case 56:return e.abrupt("return",u.length);case 57:case"end":return e.stop()}},e,U)})),function(e){return F.apply(this,arguments)})},Y="http://localhost:3000",G={state:{molecules:[],molBis:{},molSaved:[]},mutations:{clearMolecules:function(e){e.molecules=[],e.molBis={}},clearMolSaved:function(e){e.molSaved=[]},setMolSaved:function(e,t){e.molSaved=t},setMolecules:function(e,t){e.molecules=t},setMolecule:function(e,t,s){e.molecules[t]=s},saveMolecule:function(e,t){e.molSaved.findIndex(function(e){return e.id===t.id})<0&&e.molSaved.push(t)},addMolecule:function(e,t){t.id&&(e.molBis[t.id]&&(e.molBis[t.id].requests.includes(t.requests[0])||(t.requests=e.molBis[t.id].requests.concat(t.requests)),e.molBis[t.id].sources.includes(t.sources[0])||(t.sources=e.molBis[t.id].sources.concat(t.sources))),e.molBis[t.id]=t)}},actions:{searchMolecules:function(){var e=d()(l.a.mark(function e(t,s){var n,r,i,a,c,o,u,d,h=t.commit,f=t.state;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h("setLoading",!0),n=[],r=!0,i=!1,a=void 0,e.prev=5,c=m()(X.getters.selectedRequests);case 7:if(r=(o=c.next()).done){e.next=26;break}return u=o.value,console.log(u.name),n.push(u.name),e.next=13,v.a.get(Y+"/get/chembl/"+u.name).then(function(e){return console.log("exist"),console.log(e.data),e.data}).catch(function(){return console.log("error"),[]});case 13:if(!(e.sent.length<=0)){e.next=17;break}return e.next=17,K.search_molecule_structures(u.name);case 17:return e.next=19,v.a.get(Y+"/get/pubchem/"+u.name).then(function(e){return console.log("exist"),console.log(e.data),e.data}).catch(function(){return console.log("error"),[]});case 19:if(!(e.sent.length<=0)){e.next=23;break}return e.next=23,z.search_molecule_structures(u.name);case 23:r=!0,e.next=7;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(5),i=!0,a=e.t0;case 32:e.prev=32,e.prev=33,!r&&c.return&&c.return();case 35:if(e.prev=35,!i){e.next=38;break}throw a;case 38:return e.finish(35);case 39:return e.finish(32);case 40:return d=Y+"/match/chembl,pubchem/"+n.toString(),console.log(d),e.next=44,v.a.get(d).then(function(e){return console.log("matchinnnnnnnnnnnnnnnnnnng"),console.log(e.data),e.data}).catch(function(){return console.log("error"),[]});case 44:f.molecules=e.sent,console.log("endrequest");case 46:case"end":return e.stop()}},e,this,[[5,28,32,40],[33,,35,39]])}));return function(t,s){return e.apply(this,arguments)}}(),searchWithPubchem:function(){var e=d()(l.a.mark(function e(t,s){var n,r,i,a,c,o,u,d,h=t.commit,f=t.state;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h("setLoading",!0),n=[],r=!0,i=!1,a=void 0,e.prev=5,c=m()(X.getters.selectedRequests);case 7:if(r=(o=c.next()).done){e.next=20;break}return u=o.value,console.log(u.name),n.push(u.name),e.next=13,v.a.get(Y+"/get/pubchem/"+u.name).then(function(e){return console.log("exist"),console.log(e.data),e.data}).catch(function(){return console.log("error"),[]});case 13:if(!(e.sent.length<=0)){e.next=17;break}return e.next=17,z.search_molecule_structures(u.name);case 17:r=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),i=!0,a=e.t0;case 26:e.prev=26,e.prev=27,!r&&c.return&&c.return();case 29:if(e.prev=29,!i){e.next=32;break}throw a;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return d=Y+"/match/pubchem/"+n.toString(),console.log(d),e.next=38,v.a.get(d).then(function(e){return console.log("matchinnnnnnnnnnnnnnnnnnng"),console.log(e.data),e.data}).catch(function(){return console.log("error"),[]});case 38:f.molecules=e.sent,console.log("endrequest");case 40:case"end":return e.stop()}},e,this,[[5,22,26,34],[27,,29,33]])}));return function(t,s){return e.apply(this,arguments)}}(),searchWithChembl:function(){var e=d()(l.a.mark(function e(t,s){var n,r,i,a,c,o,u,d,h=t.commit,f=t.state;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h("setLoading",!0),console.log("recherche....."),n=[],r=!0,i=!1,a=void 0,e.prev=6,c=m()(X.getters.selectedRequests);case 8:if(r=(o=c.next()).done){e.next=21;break}return u=o.value,console.log(u.name),n.push(u.name),e.next=14,v.a.get(Y+"/get/chembl/"+u.name).then(function(e){return console.log("exist"),console.log(e.data),e.data}).catch(function(){return console.log("error"),[]});case 14:if(!(e.sent.length<=0)){e.next=18;break}return e.next=18,K.search_molecule_structures(u.name);case 18:r=!0,e.next=8;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(6),i=!0,a=e.t0;case 27:e.prev=27,e.prev=28,!r&&c.return&&c.return();case 30:if(e.prev=30,!i){e.next=33;break}throw a;case 33:return e.finish(30);case 34:return e.finish(27);case 35:return d=Y+"/match/chembl/"+n.toString(),console.log(d),e.next=39,v.a.get(d).then(function(e){return console.log("matchinnnnnnnnnnnnnnnnnnng"),console.log(e.data),e.data}).catch(function(){return console.log("error"),[]});case 39:f.molecules=e.sent,console.log("endrequest");case 41:case"end":return e.stop()}},e,this,[[6,23,27,35],[28,,30,34]])}));return function(t,s){return e.apply(this,arguments)}}(),clearMolecules:function(e){(0,e.commit)("clearMolecules")},clearMolSaved:function(e){(0,e.commit)("clearMolSaved")},setMolSaved:function(e,t,s){(0,e.commit)("setMolSaved",t,s)},setMolecule:function(e,t,s){(0,e.commit)("setMolecule",t,s)},addMolecule:function(e,t){(0,e.commit)("addMolecule",t)},saveMolecule:function(e,t){(0,e.commit)("saveMolecule",t)}},getters:{molecules:function(e){return e.molecules.filter(function(e){return function(e,t){var s=[],n=!0,r=!1,i=void 0;try{for(var a,c=m()(t);!(n=(a=c.next()).done);n=!0){var o=a.value;o.id&&s.push(o.id)}}catch(e){r=!0,i=e}finally{try{!n&&c.return&&c.return()}finally{if(r)throw i}}if(0===s.length)return!1;var l=!0,u=!1,d=void 0;try{for(var h,f=m()(s);!(l=(h=f.next()).done);l=!0){var v=h.value;if(e.includes(v))return!0}}catch(e){u=!0,d=e}finally{try{!l&&f.return&&f.return()}finally{if(u)throw d}}return!1}(e.sources,X.getters.dbSelected)})},molSaved:function(e){return e.molSaved},molSavedSelected:function(e){return e.molSaved.filter(function(e){return e.isSelected})}}},J={state:{requests:[]},mutations:{clearRequests:function(e){e.requests=[]},setRequests:function(e,t){e.requests=t},setRequest:function(e){console.log("value:"+e.requests[0].wasRequested)},addRequest:function(e,t){e.requests.push(t)}},actions:{clearRequests:function(e){(0,e.commit)("clearRequests")},setRequests:function(e,t){(0,e.commit)("setRequests",t)},setRequest:function(e){(0,e.commit)("setRequest"),console.log("fdffdfhdkfhk ")},addRequest:function(e,t){(0,e.commit)("addRequest",t)}},getters:{requests:function(e){return e.requests},selectedRequests:function(e){return e.requests.filter(function(e){return e.isSelected})}}};n.a.use(r.a);var X=new r.a.Store({modules:{molecule:G,shared:{state:{databases:[{id:"pubchem",name:"Pubchem database",isSelected:!0},{id:"chembl",name:"Chembl database",isSelected:!1}],loading:null,error:null},mutations:{setLoading:function(e,t){e.loading=t},setError:function(e,t){e.error=t},clearError:function(e){e.error=null}},actions:{clearError:function(e){(0,e.commit)("clearError")},setLoading:function(e,t){(0,e.commit)("setLoading",t)},setError:function(e,t){(0,e.commit)("setError",t)}},getters:{loading:function(e){return e.loading},error:function(e){return e.error},databases:function(e){return e.databases},dbSelected:function(e){return e.databases.filter(function(e){return e.isSelected})}}},request:J}}),Z=s("bqTm");n.a.use(Z),n.a.use(P.a),n.a.use(D.a),n.a.use(I.a),n.a.use(T.a),n.a.use(r.a),n.a.config.productionTip=!1,new n.a({el:"#app",router:E,store:X,components:{App:a},template:"<App/>"})},b77a:function(e,t){},rrYP:function(e,t){},xjZs:function(e,t){},y9Hz:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.dc889ec12b42a138b53d.js.map